(this["webpackJsonpreact-pong"]=this["webpackJsonpreact-pong"]||[]).push([[0],{13:function(t,e,i){},15:function(t,e,i){"use strict";i.r(e);var s=i(1),a=i.n(s),h=i(7),n=i.n(h),r=(i(13),i(5)),c=i(2),l=i(3);function o(t,e,i,s){return i||(i=0),s||(s=0),Math.sqrt((i-t)*(i-t)+(s-e)*(s-e))}function u(t,e){return Math.random()*(e-t)+t}function y(t,e){return Math.floor(u(t,e))}var d=function(){function t(e){Object(c.a)(this,t),this.x=100,this.y=100,this.w=10,this.h=100,this.score=0,this.game=e,this.speed=450,this.randomTick=0,this.randomValue=0}return Object(l.a)(t,[{key:"moveToCenter",value:function(){this.y=this.game.canvas.height/2-this.h/2}},{key:"isControlling",value:function(){return!this.game.demo&&this===this.game.player1}},{key:"isCPU",value:function(){return this.game.demo||this===this.game.player2}},{key:"getCenter",value:function(){return[this.x+this.w/2,this.y+this.h/2]}},{key:"render",value:function(){this.game.ctx.fillStyle="#fff",this.game.ctx.fillRect(this.x,this.y,this.w,this.h)}},{key:"update",value:function(t){if(this.isCPU())if(this.game.cpu){var e=this===this.game.player1?this.game.player2:this.game.player1,i=o(this.x,this.y,e.x,e.y),s=o(this.x,this.y,this.game.ball.x,this.game.ball.y);if(this.randomTick+=t,this.randomTick>4&&(this.randomTick=0,this.randomValue=y(-this.h/2,this.h/2)),s<i/2)Math.abs(this.game.ball.y-(this.game.ball.y>this.y+this.h/2))>5&&(this.game.ball.y>this.y+this.h/2+this.randomValue?this.y+=t*this.speed:this.y-=t*this.speed);else Math.abs(this.game.canvas.height/2-(this.y+this.h/2+this.randomValue))>5&&(this.y+this.h/2+this.randomValue>this.game.canvas.height/2?this.y-=t*this.speed:this.y+=t*this.speed)}else this.game.inputManager.isKeyDown("ArrowUp")&&(this.y-=t*this.speed),this.game.inputManager.isKeyDown("ArrowDown")&&(this.y+=t*this.speed);this.isControlling()&&(this.game.inputManager.isKeyDown("w")&&(this.y-=t*this.speed),this.game.inputManager.isKeyDown("s")&&(this.y+=t*this.speed)),this.y=Math.min(this.game.canvas.height-this.h,Math.max(0,this.y))}}]),t}(),v=function(){function t(e){Object(c.a)(this,t),this.x=100,this.y=100,this.r=10,this.vx=0,this.vy=0,this.game=e,this.trailTick=0,this.bounces=0}return Object(l.a)(t,[{key:"moveToCenter",value:function(){this.x=this.game.canvas.width/2,this.y=this.game.canvas.height/2}},{key:"clearVelocity",value:function(){this.vx=0,this.vy=0,this.bounces=0}},{key:"setRandomVelocity",value:function(){var t=this.game.canvas.width/4,e=this.game.canvas.height/4;this.vx=u(t/1.6,t)*(Math.random()>.5?1:-1),this.vy=u(e/1.6,e)*(Math.random()>.5?1:-1)}},{key:"bounceEffect",value:function(t,e){this.bounces++;var i=Math.max(.01,this.bounces/200);this.vx*=1+i,this.vy*=1+i,this.game.particleSystem.spawnParticles(null!==t&&void 0!==t?t:this.x,null!==e&&void 0!==e?e:this.y)}},{key:"render",value:function(){this.game.ctx.beginPath(),this.game.ctx.fillStyle="#fff",this.game.ctx.arc(this.x,this.y,this.r,0,2*Math.PI),this.game.ctx.fill(),this.game.ctx.closePath()}},{key:"getSpeed",value:function(){return Math.pow(Math.max(Math.abs(this.vx),Math.abs(this.vy)),2)}},{key:"update",value:function(t){this.x+=this.vx*t,this.y+=this.vy*t,this.trailTick+=t,this.trailTick*this.bounces>1e5/this.getSpeed()&&(this.trailTick=0,this.game.particleSystem.spawnParticles(this.x,this.y,1,.1)),this.x<this.r&&(this.vx=Math.abs(this.vx),this.x=this.r,this.bounceEffect()),this.y<this.r&&(this.vy=Math.abs(this.vy),this.y=this.r,this.bounceEffect()),this.x>this.game.canvas.width-this.r&&(this.vx=-Math.abs(this.vx),this.x=this.game.canvas.width-this.r,this.bounceEffect()),this.y>this.game.canvas.height-this.r&&(this.vy=-Math.abs(this.vy),this.y=this.game.canvas.height-this.r,this.bounceEffect()),this.collidesWithRect(this.game.player1)&&this.handleCollision(this.game.player1),this.collidesWithRect(this.game.player2)&&this.handleCollision(this.game.player2)}},{key:"handleCollision",value:function(t){var e=t.getCenter(),i=Math.atan2(this.y-e[1],this.x-e[0]),s=Math.max(Math.abs(this.vx),Math.abs(this.vy)),a=[Math.cos(i)*s,Math.sin(i)*s];this.vx=a[0],this.vy=a[1],t===this.game.player1?(this.vx<s&&(this.vx=s),this.bounceEffect(t.x+t.w,this.y)):t===this.game.player2&&(this.vx<-s&&(this.vx=-s),this.bounceEffect(t.x-2,this.y))}},{key:"collidesWithRect",value:function(t){var e=this,i=Math.abs(e.x-t.x-t.w/2),s=Math.abs(e.y-t.y-t.h/2);if(i>t.w/2+e.r)return!1;if(s>t.h/2+e.r)return!1;if(i<=t.w/2)return!0;if(s<=t.h/2)return!0;var a=i-t.w/2,h=s-t.h/2;return a*a+h*h<=e.r*e.r}}]),t}(),m=function(){function t(){Object(c.a)(this,t),this.keyboard=Object.create(null),this.mousePosition=[],this.events=[]}return Object(l.a)(t,[{key:"attach",value:function(){var t=this;window.addEventListener("keydown",(function(e){t.handleKeyEvent(e,!0)})),window.addEventListener("keyup",(function(e){t.handleKeyEvent(e,!1)})),window.addEventListener("mousemove",(function(e){t.handleMouseMove(e)}))}},{key:"isKeyDown",value:function(t){return!!this.keyboard[t.toLowerCase()]}},{key:"getMousePosition",value:function(){return this.mousePosition}},{key:"handleKeyEvent",value:function(t,e){this.keyboard[t.key.toLowerCase()]=e}},{key:"handleMouseMove",value:function(t){this.mousePosition=[t.clientX,t.clientY]}}]),t}(),p=i(8),f=function(){function t(e){Object(c.a)(this,t),this.game=e,this.particles=[]}return Object(l.a)(t,[{key:"spawnParticles",value:function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=1===i?i:y(.9*i,1.1*i),h=0;h<a;h++){var n=u(0,2*Math.PI),r=u(.1,6),c=Math.cos(n)*u(3,5),l=Math.sin(n)*u(3,5);this.particles.push({x:t+c,y:e+l,size:u(3,6*s),ticks:u(0,1),vx:Math.cos(n)*r,vy:Math.sin(n)*r,alpha:u(0,.1)})}}},{key:"render",value:function(){var t,e=Object(p.a)(this.particles);try{for(e.s();!(t=e.n()).done;){var i=t.value;this.game.ctx.globalAlpha=i.alpha,this.game.ctx.fillStyle="#fff",this.game.ctx.fillRect(i.x,i.y,i.size,i.size)}}catch(s){e.e(s)}finally{e.f()}this.game.ctx.globalAlpha=1}},{key:"update",value:function(t){for(var e=[],i=0;i<this.particles.length;i++){var s=this.particles[i];s.x+=t*s.vx,s.y+=t*s.vy,s.ticks+=t,s.ticks>3?(s.size-=t,(s.size<.01||s.alpha<.01)&&e.unshift(i)):s.alpha<1&&(s.alpha+=3*t)}for(i=0;i<e.length;i++)this.particles.splice(e[i],1)}}]),t}(),b=function(){function t(e,i,s){Object(c.a)(this,t),this.canvas=e,this.ctx=i,this.updateScoresCallback=s,this.inputManager=new m,this.particleSystem=new f(this),this.player1=new d(this),this.player2=new d(this),this.ball=new v(this),this.ballActive=!1,this.demo=!0,this.cpu=!0,this.resetId=""}return Object(l.a)(t,[{key:"start",value:function(){this.inputManager.attach()}},{key:"reset",value:function(){var t=this;this.updateScoresCallback(this.player1.score,this.player2.score),this.ball.moveToCenter(),this.ball.clearVelocity(),this.ballActive=!1,this.particleSystem.particles=[];var e={};this.resetId=e,setTimeout((function(){t.resetId===e&&(t.ball.setRandomVelocity(),t.ball.bounceEffect(),t.ballActive=!0)}),1e3)}},{key:"render",value:function(){this.ctx.fillStyle="#222",this.ctx.fillRect(this.canvas.width/2-1,0,2,this.canvas.height),this.player1.render(),this.player2.render(),this.ball.render(),this.particleSystem.render()}},{key:"update",value:function(t){this.player1.update(t),this.player2.update(t),this.ballActive&&this.ball.update(t),this.particleSystem.update(t),this.ball.x+this.ball.r<this.player1.x&&(this.player2.score++,this.reset()),this.ball.x-this.ball.r>this.player2.x+this.player2.w&&(this.player1.score++,this.reset())}}]),t}(),g=i(0);var x=function(){var t,e=Object(s.useRef)(),i=Object(s.useState)(0),a=Object(r.a)(i,2),h=a[0],n=a[1],c=Object(s.useState)(0),l=Object(r.a)(c,2),o=l[0],u=l[1],y=Object(s.useState)(!1),d=Object(r.a)(y,2),v=d[0],m=d[1],p=Object(s.useRef)();return Object(s.useEffect)((function(){var t=e.current;if(t){var i=t.getContext("2d"),s=performance.now(),a=new b(t,i,(function(t,e){n(t),u(e)}));p.current=a;var h=function(){t.width=window.innerWidth,t.height=window.innerHeight,t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px",a.player2.x=window.innerWidth-100};return h(),a.player1.moveToCenter(),a.player2.moveToCenter(),a.ball.moveToCenter(),r(),setTimeout((function(){a.start(),a.reset(),m(!0)}),100),window.addEventListener("resize",h),function(){cancelAnimationFrame(r),window.removeEventListener("resize",h)}}function r(){var e=performance.now(),h=(e-s)/1e3;s=e,i.fillStyle="#000",i.fillRect(0,0,t.width,t.height),a.update(h),a.render(),requestAnimationFrame(r)}}),[]),Object(g.jsxs)("div",{className:v?"":"hide-cursor",children:[Object(g.jsxs)("div",{className:"main-menu"+(v?" main-menu-show":""),children:[Object(g.jsx)("h1",{children:"Pong"}),Object(g.jsx)("p",{children:"by: MichaelXF"}),Object(g.jsx)("button",{className:"main-btn",onClick:function(){p.current.player1.score=0,p.current.player2.score=0,p.current.particleSystem.particles=[],p.current.player1.moveToCenter(),p.current.player2.moveToCenter(),p.current.ball.moveToCenter(),p.current.demo=!1,p.current.cpu=!0,p.current.reset(),m(!1)},children:"Player vs. CPU"}),Object(g.jsx)("button",{className:"main-btn",onClick:function(){p.current.player1.score=0,p.current.player2.score=0,p.current.particleSystem.particles=[],p.current.player1.moveToCenter(),p.current.player2.moveToCenter(),p.current.ball.moveToCenter(),p.current.demo=!1,p.current.cpu=!1,p.current.reset(),m(!1)},children:"Player vs. Player"})]}),Object(g.jsx)("canvas",{ref:e}),Object(g.jsxs)("div",{className:"scoreboard",children:[Object(g.jsx)("div",{className:"scoreboard-p1",children:h}),Object(g.jsx)("div",{className:"scoreboard-p2",children:o})]}),Object(g.jsxs)("div",{className:"controls",children:[Object(g.jsxs)("div",{className:"controls-p1",children:[Object(g.jsx)("kbd",{children:"W"}),Object(g.jsx)("kbd",{children:"S"})]}),Object(g.jsx)("div",{className:"controls-p2",children:(null===p||void 0===p||null===(t=p.current)||void 0===t?void 0:t.cpu)?Object(g.jsx)("kbd",{children:"CPU"}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("kbd",{children:"\ud83e\udc15"}),Object(g.jsx)("kbd",{children:Object(g.jsx)("span",{style:{transform:"translate(0, 2px)",display:"inline-block"},children:"\ud83e\udc17"})})]})})]})]})},j=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,16)).then((function(e){var i=e.getCLS,s=e.getFID,a=e.getFCP,h=e.getLCP,n=e.getTTFB;i(t),s(t),a(t),h(t),n(t)}))};n.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(x,{})}),document.getElementById("root")),j()}},[[15,1,2]]]);
//# sourceMappingURL=main.2c9a14fc.chunk.js.map